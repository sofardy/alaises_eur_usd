# üî¨ –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ü–û–î–†–û–ë–ù–û–°–¢–ò –ê–ù–ê–õ–ò–ó–ê

## üéØ –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–±—ä—è—Å–Ω—è–µ—Ç **–ø–æ—à–∞–≥–æ–≤–æ**, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à–∏ —Ç–æ—Ä–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## üìä –í–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï - –î–ï–¢–ê–õ–¨–ù–û

### –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤:

```csv
Date,Time,Open,High,Low,Close,Volume
2024.01.01,00:00,1.10450,1.10480,1.10420,1.10455,0
2024.01.01,00:01,1.10455,1.10470,1.10440,1.10460,0
...
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

```python
# 1. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏
df['Datetime'] = pd.to_datetime(df['Date'] + ' ' + df['Time'])

# 2. –ü–µ—Ä–µ–≤–æ–¥ –≤ UTC+3
df['Datetime'] = df['Datetime'] + pd.Timedelta(hours=3)

# 3. –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
df = df[['Datetime', 'Open', 'High', 'Low', 'Close']]
```

---

## ‚è∞ –í–†–ï–ú–ï–ù–ù–´–ï –°–ï–°–°–ò–ò

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞–º–æ–∫ (UTC+3):

```python
def get_session_data(self, df, date, start_hour, end_hour):
    """–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Å—Å–∏–∏"""
    session_start = pd.Timestamp(date) + pd.Timedelta(hours=start_hour)
    session_end = pd.Timestamp(date) + pd.Timedelta(hours=end_hour)

    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    mask = (df['Datetime'] >= session_start) & (df['Datetime'] < session_end)
    return df[mask].copy()
```

### –°–µ—Å—Å–∏–∏:

- **–ê–∑–∏—è:** `get_session_data(df, date, 2, 10)` # 02:00-10:00
- **–§—Ä–∞–Ω–∫—Ñ—É—Ä—Ç:** `get_session_data(df, date, 9, 10)` # 09:00-10:00
- **–õ–æ–Ω–¥–æ–Ω:** `get_session_data(df, date, 10, 15)` # 10:00-15:00
- **–ù—å—é-–ô–æ—Ä–∫:** `get_session_data(df, date, 15, 19)` # 15:00-19:00

---

## üéØ –†–ê–°–ß–ï–¢ ASIA LEVELS

### –ö–æ–¥ —Ä–∞—Å—á–µ—Ç–∞:

```python
def calculate_asia_levels(self, df, date):
    """–†–∞—Å—á–µ—Ç Asia High/Low/Mid –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∞—Ç—ã"""
    asia_data = self.get_session_data(df, date, 2, 10)  # 02:00-10:00

    if asia_data.empty:
        return None, None, None

    asia_high = asia_data['High'].max()  # –ú–∞–∫—Å–∏–º—É–º –∑–∞ —Å–µ—Å—Å–∏—é
    asia_low = asia_data['Low'].min()    # –ú–∏–Ω–∏–º—É–º –∑–∞ —Å–µ—Å—Å–∏—é
    asia_mid = (asia_high + asia_low) / 2  # –°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è

    return asia_high, asia_low, asia_mid
```

### –ü—Ä–∏–º–µ—Ä –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:

```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (02:00-10:00):
02:00: High=1.1055, Low=1.1045
02:01: High=1.1058, Low=1.1050
...
09:59: High=1.1062, Low=1.1040

–†–µ–∑—É–ª—å—Ç–∞—Ç:
asia_high = max(1.1055, 1.1058, ..., 1.1062) = 1.1062
asia_low = min(1.1045, 1.1050, ..., 1.1040) = 1.1040
asia_mid = (1.1062 + 1.1040) / 2 = 1.1051
```

---

## üîç –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï SWEEP (–ü–†–û–ë–ò–¢–ò–ô)

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–±–∏—Ç–∏—è:

```python
def check_frankfurt_sweep(self, df, date, asia_high, asia_low):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ Frankfurt Sweep (09:00-10:00)"""
    frankfurt_data = self.get_session_data(df, date, 9, 10)

    if frankfurt_data.empty:
        return False, False, None, None

    frankfurt_high = frankfurt_data['High'].max()
    frankfurt_low = frankfurt_data['Low'].min()

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–∏—Ç–∏—è (–º–∏–Ω–∏–º—É–º –Ω–∞ 1 –ø—É–Ω–∫—Ç = 0.00010)
    sweep_high = frankfurt_high >= (asia_high + 0.00010)
    sweep_low = frankfurt_low <= (asia_low - 0.00010)

    return sweep_high, sweep_low, high_time, low_time
```

### –£—Å–ª–æ–≤–∏—è –ø—Ä–æ–±–∏—Ç–∏—è:

- **Sweep High:** `price >= asia_high + 0.00010`
- **Sweep Low:** `price <= asia_low - 0.00010`
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø—Ä–æ–±–∏—Ç–∏–µ:** 1 –ø—É–Ω–∫—Ç (0.00010 –¥–ª—è EUR/USD)

---

## üìä –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –î–í–ò–ñ–ï–ù–ò–Ø

### –ê–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –õ–æ–Ω–¥–æ–Ω—Å–∫–æ–π —Å–µ—Å—Å–∏–∏:

```python
def determine_london_direction(self, df, date, sweep_time, sweep_price):
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –õ–æ–Ω–¥–æ–Ω–∞"""

    if sweep_time is not None:
        # –ï—Å–ª–∏ –µ—Å—Ç—å sweep - —Å—á–∏—Ç–∞–µ–º –æ—Ç –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–æ–±–∏—Ç–∏—è
        london_end = sweep_time.replace(hour=15, minute=0)
        after_sweep = df[(df['Datetime'] > sweep_time) &
                        (df['Datetime'] <= london_end)]

        if after_sweep.empty:
            return None

        high = after_sweep['High'].max()
        low = after_sweep['Low'].min()

        up_move = high - sweep_price    # –î–≤–∏–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö –æ—Ç sweep
        down_move = sweep_price - low   # –î–≤–∏–∂–µ–Ω–∏–µ –≤–Ω–∏–∑ –æ—Ç sweep

    else:
        # –ï—Å–ª–∏ –Ω–µ—Ç sweep - —Å—á–∏—Ç–∞–µ–º –æ—Ç –Ω–∞—á–∞–ª–∞ –õ–æ–Ω–¥–æ–Ω–∞ (10:00)
        london_data = self.get_session_data(df, date, 10, 15)

        if london_data.empty:
            return None

        london_open = london_data.iloc[0]['Open']
        high = london_data['High'].max()
        low = london_data['Low'].min()

        up_move = high - london_open
        down_move = london_open - low

    return 'Long' if up_move > down_move else 'Short'
```

---

## üéØ –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø SWEEP TYPE

### –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞:

```python
def determine_sweep_type(self, sweep_high, sweep_low, london_direction,
                        asia_high, asia_low, sweep_price):
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ sweep"""

    if not sweep_high and not sweep_low:
        return 'No Sweep'

    if london_direction is None:
        return 'No Sweep'

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–æ–π sweep –ø—Ä–æ–∏–∑–æ—à–µ–ª
    if sweep_high and (not sweep_low or sweep_price == asia_high):
        # Sweep Asia High
        if london_direction == 'Long':
            return 'Continue'       # –ü—Ä–æ–±–∏–ª–∏ –≤–≤–µ—Ä—Ö –∏ –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∏ –≤–≤–µ—Ä—Ö
        else:
            return 'Sweep and Reverse'  # –ü—Ä–æ–±–∏–ª–∏ –≤–≤–µ—Ä—Ö, –Ω–æ –ø–æ—à–ª–∏ –≤–Ω–∏–∑

    elif sweep_low and (not sweep_high or sweep_price == asia_low):
        # Sweep Asia Low
        if london_direction == 'Short':
            return 'Continue'       # –ü—Ä–æ–±–∏–ª–∏ –≤–Ω–∏–∑ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∏ –≤–Ω–∏–∑
        else:
            return 'Sweep and Reverse'  # –ü—Ä–æ–±–∏–ª–∏ –≤–Ω–∏–∑, –Ω–æ –ø–æ—à–ª–∏ –≤–≤–µ—Ä—Ö

    return 'No Sweep'
```

### –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

| –ü—Ä–æ–±–∏—Ç–∏–µ  | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –õ–æ–Ω–¥–æ–Ω–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç         |
| --------- | ------------------- | ----------------- |
| Asia High | Long                | Continue          |
| Asia High | Short               | Sweep and Reverse |
| Asia Low  | Short               | Continue          |
| Asia Low  | Long                | Sweep and Reverse |
| –ù–µ—Ç       | –õ—é–±–æ–µ               | No Sweep          |

---

## üîÑ –ü–†–û–í–ï–†–ö–ê REBALANCE

### –£—Å–ª–æ–≤–∏—è Rebalance:

1. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **Sweep and Reverse**
2. –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ **–¥–æ—Ç—Ä–æ–Ω—É—Ç—å—Å—è** –¥–æ Asia Mid (¬±3 –ø—É–Ω–∫—Ç–∞)
3. –ü–æ—Å–ª–µ –∫–∞—Å–∞–Ω–∏—è - **–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

### –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏:

```python
def check_rebalance(self, df, sweep_time, sweep_type, asia_mid, london_direction):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ Rebalance"""

    if sweep_type != 'Sweep and Reverse' or sweep_time is None:
        return 'No'

    # –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ sweep –¥–æ 15:00
    london_end = sweep_time.replace(hour=15, minute=0)
    after_sweep_data = df[(df['Datetime'] > sweep_time) &
                         (df['Datetime'] <= london_end)]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Å–∞–Ω–∏–µ Asia Mid ¬±3 –ø—É–Ω–∫—Ç–∞
    touched_mid = False
    mid_touch_time = None

    for idx, row in after_sweep_data.iterrows():
        if (abs(row['High'] - asia_mid) <= 0.00030 or
            abs(row['Low'] - asia_mid) <= 0.00030):
            touched_mid = True
            mid_touch_time = row['Datetime']
            break

    if not touched_mid:
        return 'No'

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞—Å–∞–Ω–∏—è
    after_mid_data = after_sweep_data[after_sweep_data['Datetime'] > mid_touch_time]

    if london_direction == 'Long':
        # –û—Å–Ω–æ–≤–Ω–æ–π —Ä—É—Ö –≤–≤–µ—Ä—Ö, –ø–æ—Å–ª–µ rebalance –¥–æ–ª–∂–Ω–æ –∏–¥—Ç–∏ –≤–Ω–∏–∑
        min_after_mid = after_mid_data['Low'].min()
        return 'Yes' if min_after_mid < (asia_mid - 0.00010) else 'No'
    else:
        # –û—Å–Ω–æ–≤–Ω–æ–π —Ä—É—Ö –≤–Ω–∏–∑, –ø–æ—Å–ª–µ rebalance –¥–æ–ª–∂–Ω–æ –∏–¥—Ç–∏ –≤–≤–µ—Ä—Ö
        max_after_mid = after_mid_data['High'].max()
        return 'Yes' if max_after_mid > (asia_mid + 0.00010) else 'No'
```

---

## üìè –†–ê–°–ß–ï–¢ –†–ê–°–®–ò–†–ï–ù–ò–ô

### –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞:

```python
def calculate_extensions(self, df, date, sweep_time, sweep_price,
                        sweep_high, sweep_low, asia_range):
    """–†–∞—Å—á–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø–æ—Å–ª–µ sweep"""

    if asia_range == 0:
        return 0, 0, None, None, 0, 0

    # –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ sweep –¥–æ 15:00
    london_end = sweep_time.replace(hour=15, minute=0)
    after_sweep_data = df[(df['Datetime'] > sweep_time) &
                         (df['Datetime'] <= london_end)]

    max_high = after_sweep_data['High'].max()
    min_low = after_sweep_data['Low'].min()

    # –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –ø—É–Ω–∫—Ç–∞—Ö –æ—Ç sweep price
    if sweep_high:
        extension_pips = (max_high - sweep_price) / 0.00010
        reverse_pips = (sweep_price - min_low) / 0.00010
    else:
        extension_pips = (sweep_price - min_low) / 0.00010
        reverse_pips = (max_high - sweep_price) / 0.00010

    # –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç Asia Range
    extension_percent = (extension_pips * 0.00010) / asia_range * 100
    reverse_percent = (reverse_pips * 0.00010) / asia_range * 100

    return extension_pips, extension_percent, max_time, min_time, \
           reverse_pips, reverse_percent
```

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:

```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
sweep_price = 1.1065 (–ø—Ä–æ–±–∏–ª–∏ Asia High)
max_high = 1.1075 (–º–∞–∫—Å–∏–º—É–º –ø–æ—Å–ª–µ –ø—Ä–æ–±–∏—Ç–∏—è)
asia_range = 1.1060 - 1.1040 = 0.0020

–†–∞—Å—á–µ—Ç:
extension_pips = (1.1075 - 1.1065) / 0.00010 = 10.0 –ø—É–Ω–∫—Ç–æ–≤
extension_percent = (0.0010 / 0.0020) * 100 = 50.0%
```

---

## üè¢ –ê–ù–ê–õ–ò–ó –ù–¨–Æ-–ô–û–†–ö–°–ö–û–ô –°–ï–°–°–ò–ò

### –ê–ª–≥–æ—Ä–∏—Ç–º:

```python
def analyze_new_york_session(self, df, date, asia_high, asia_low, london_direction):
    """–ê–Ω–∞–ª–∏–∑ –ù—å—é-–ô–æ—Ä–∫—Å–∫–æ–π —Å–µ—Å—Å–∏–∏ (15:00-19:00)"""

    ny_data = self.get_session_data(df, date, 15, 19)

    # NY Open - –ø–µ—Ä–≤–∞—è —Å–≤–µ—á–∞ –≤ 15:00
    ny_open = ny_data.iloc[0]['Open']
    ny_high = ny_data['High'].max()
    ny_low = ny_data['Low'].min()

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è NY
    up_move = ny_high - ny_open
    down_move = ny_open - ny_low
    ny_direction = 'Long' if up_move > down_move else 'Short'

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –õ–æ–Ω–¥–æ–Ω–∞
    if london_direction == ny_direction:
        ny_status = 'Support'    # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –õ–æ–Ω–¥–æ–Ω–∞
    else:
        ny_status = 'Reverse'    # –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –õ–æ–Ω–¥–æ–Ω–∞

    return {
        'ny_direction': ny_direction,
        'ny_status': ny_status,
        'ny_up_extension_pips': (ny_high - ny_open) / 0.00010,
        'ny_down_extension_pips': (ny_open - ny_low) / 0.00010,
        # ... –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏
    }
```

---

## üìä –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ –ê–ù–ê–õ–ò–ó–ê –î–ù–Ø

### –§—É–Ω–∫—Ü–∏—è analyze_day –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã:

```python
def analyze_day(self, df, date):
    """–ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –¥–Ω—è"""

    # 1. –†–∞—Å—á–µ—Ç Asia —É—Ä–æ–≤–Ω–µ–π
    asia_high, asia_low, asia_mid = self.calculate_asia_levels(df, date)

    # 2. –†–∞—Å—á–µ—Ç PDH/PDL (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å)
    pdh, pdl = self.calculate_pdh_pdl(df, date)

    # 3. Frankfurt Sweep
    frankfurt_sweep_high, frankfurt_sweep_low, f_h_time, f_l_time = \
        self.check_frankfurt_sweep(df, date, asia_high, asia_low)

    # 4. London Sweep
    london_sweep_high, london_sweep_low, sweep_price, sweep_time, l_h_time, l_l_time = \
        self.check_london_sweep(df, date, asia_high, asia_low)

    # 5. –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –õ–æ–Ω–¥–æ–Ω–∞
    london_direction = self.determine_london_direction(df, date, sweep_time, sweep_price)

    # 6. –¢–∏–ø sweep
    sweep_type = self.determine_sweep_type(
        london_sweep_high, london_sweep_low, london_direction,
        asia_high, asia_low, sweep_price
    )

    # 7. Rebalance
    rebalance = self.check_rebalance(df, sweep_time, sweep_type, asia_mid, london_direction)

    # 8. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è
    extension_pips, extension_percent, max_time, min_time, reverse_pips, reverse_percent = \
        self.calculate_extensions(df, date, sweep_time, sweep_price,
                                london_sweep_high, london_sweep_low, asia_range)

    # 9. Retests
    retest_sweep, retest_mid = self.check_retests(df, sweep_time, sweep_price, asia_mid)

    # 10. PDH/PDL Sweep
    sweep_pdh, sweep_pdl, pdh_time, pdl_time = self.check_pdh_pdl_sweep(df, date, pdh, pdl)

    # 11. –ê–Ω–∞–ª–∏–∑ –ù—å—é-–ô–æ—Ä–∫–∞
    ny_analysis = self.analyze_new_york_session(df, date, asia_high, asia_low, london_direction)

    # 12. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    return {
        'date': date_str,
        'day_of_week': day_name,
        'asia_high': round(asia_high, 5),
        'asia_low': round(asia_low, 5),
        'asia_mid': round(asia_mid, 5),
        'frankfurt_sweep_high': 'Yes' if frankfurt_sweep_high else 'No',
        'london_sweep_high': 'Yes' if london_sweep_high else 'No',
        'sweep_type': sweep_type,
        'london_direction': london_direction,
        'rebalance': rebalance,
        'extension_pips': round(extension_pips, 1),
        'extension_percent': round(extension_percent, 2),
        # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 30+ –º–µ—Ç—Ä–∏–∫
        **ny_analysis
    }
```

---

## üöÄ –ú–ê–°–°–û–í–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤:

```python
def process_all_files(self):
    """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ files/"""

    files_list = self.get_files_list()  # –ù–∞–π—Ç–∏ –≤—Å–µ CSV/XLSX —Ñ–∞–π–ª—ã

    for i, file_path in enumerate(files_list, 1):
        print(f"üìÅ –§–∞–π–ª {i}/{len(files_list)}: {os.path.basename(file_path)}")

        try:
            # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–º–æ–∂–µ—Ç –±—ã—Ç—å 500,000+ —Å—Ç—Ä–æ–∫)
            df = analyzer.load_data(file_path)

            # –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –¥–Ω–µ–π –≤ —Ñ–∞–π–ª–µ
            results = analyzer.analyze_period(df)

            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            output_path = f"analysis_{currency_pair}_{period}_{timestamp}.xlsx"
            analyzer.save_results(results, output_path)

            print(f"‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ {len(results)} —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω–µ–π")

        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞: {str(e)}")
```

---

## üìà –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è:

1. **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è pandas:** –∏–∑–±–µ–≥–∞–µ–º —Ü–∏–∫–ª–æ–≤ Python
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏:** —Ä–∞–±–æ—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ —Å –Ω—É–∂–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. **–ü–∞–º—è—Ç—å:** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ –¥–Ω—è–º, –Ω–µ –¥–µ—Ä–∂–∏–º –≤–µ—Å—å —Ñ–∞–π–ª
4. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å:** GUI –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –∏–∑–±–µ–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```python
# –ú–ï–î–õ–ï–ù–ù–û (—Ü–∏–∫–ª—ã Python):
for index, row in df.iterrows():
    if row['High'] > asia_high:
        sweep = True

# –ë–´–°–¢–†–û (–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è pandas):
sweep = (df['High'] > asia_high).any()
```

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** –¥–ª—è –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è —Å—ã—Ä—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ —Ä—ã–Ω–∫–∞ EUR/USD.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò–∑ –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ç–∫–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π! üìä

---

_–¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –≤—Å—é "–∫—É—Ö–Ω—é" –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö! üî¨_
